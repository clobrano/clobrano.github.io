<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7" lang="en"> <![endif]-->
<!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8" lang="en"><![endif]-->
<!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9" lang="en"><![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"><!--<![endif]-->
<head>
<meta charset="utf-8">
<title>What Goes Around, Comes Around &#8211; Quantum Leap</title>
<meta name="description" content="Fun with overflows">
<meta name="keywords" content="python">



<!-- Twitter Cards -->
<meta name="twitter:title" content="What Goes Around, Comes Around">
<meta name="twitter:description" content="Fun with overflows">
<meta name="twitter:site" content="@carlolobrano">
<meta name="twitter:creator" content="@carlolobrano">

<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://localhost:4000/images/site-logo.png">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="What Goes Around, Comes Around">
<meta property="og:description" content="Fun with overflows">
<meta property="og:url" content="http://localhost:4000/blog/what-goes-around-comes-around/">
<meta property="og:site_name" content="Quantum Leap">





<link rel="canonical" href="http://localhost:4000/blog/what-goes-around-comes-around/">
<link href="http://localhost:4000/feed.xml" type="application/atom+xml" rel="alternate" title="Quantum Leap Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- For all browsers -->
<link rel="stylesheet" href="http://localhost:4000/assets/css/main.css">
<!-- Webfonts -->
<script src="https://use.edgefonts.net/source-sans-pro:n2,i2,n3,i3,n4,i4,n6,i6,n7,i7,n9,i9;source-code-pro:n4,n7;volkhov.js"></script>

<meta http-equiv="cleartype" content="on">

<!-- HTML5 Shiv and Media Query Support -->
<!--[if lt IE 9]>
  <script src="http://localhost:4000/assets/js/vendor/html5shiv.min.js"></script>
  <script src="http://localhost:4000/assets/js/vendor/respond.min.js"></script>
<![endif]-->

<!-- Modernizr -->
<script src="http://localhost:4000/assets/js/vendor/modernizr-2.7.1.custom.min.js"></script>


<!-- MathJax -->
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


<!-- Icons -->
<!-- 16x16 -->
<link rel="shortcut icon" href="http://localhost:4000/favicon.ico">
<!-- 32x32 -->
<link rel="shortcut icon" href="http://localhost:4000/favicon.png">
<!-- 57x57 (precomposed) for iPhone 3GS, pre-2011 iPod Touch and older Android devices -->
<link rel="apple-touch-icon-precomposed" href="http://localhost:4000/images/apple-touch-icon-precomposed.png">
<!-- 72x72 (precomposed) for 1st generation iPad, iPad 2 and iPad mini -->
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://localhost:4000/images/apple-touch-icon-72x72-precomposed.png">
<!-- 114x114 (precomposed) for iPhone 4, 4S, 5 and post-2011 iPod Touch -->
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://localhost:4000/images/apple-touch-icon-114x114-precomposed.png">
<!-- 144x144 (precomposed) for iPad 3rd and 4th generation -->
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://localhost:4000/images/apple-touch-icon-144x144-precomposed.png">

</head>

<body id="post">

<div class="navigation-wrapper">
	<nav role="navigation" id="site-nav" class="animated drop">
	    <ul>
      
		    
		        
		    
		    <li><a href="http://localhost:4000/about/" >About</a></li>
		  
		    
		        
		    
		    <li><a href="http://localhost:4000/articles/" >Articles</a></li>
		  
		    
		        
		    
		    <li><a href="http://localhost:4000/blog/" >Blog</a></li>
		  
		    
		        
		    
		    <li><a href="http://localhost:4000/tags/" >Tags</a></li>
		  
		    
		        
		    
		    <li><a href="http://localhost:4000/search/" >Search</a></li>
		  
	    </ul>
	</nav>
</div><!-- /.navigation-wrapper -->

<!--[if lt IE 9]><div class="upgrade"><strong><a href="http://whatbrowser.org/">Your browser is quite old!</strong> Why not upgrade to a different browser to better enjoy this site?</a></div><![endif]-->

<header class="masthead">
	<div class="wrap">
      
  		<a href="http://localhost:4000/" class="site-logo" rel="home" title="Quantum Leap"><img src="http://localhost:4000/images/site-logo.png" width="200" height="200" alt="Quantum Leap logo" class="animated fadeInDown"></a>
      
      <h1 class="site-title animated fadeIn"><a href="http://localhost:4000/">Quantum Leap</a></h1>
		<h2 class="site-description animated fadeIn" itemprop="description">Development, Smart Tools and Automation</h2>
	</div>
</header><!-- /.masthead -->

<div class="js-menu-screen menu-screen"></div>


<div id="main" role="main">
  <article class="hentry">
    
    <div class="entry-wrapper">
      <header class="entry-header">
        <span class="entry-tags"><a href="http://localhost:4000/tags/#python" title="Pages tagged python">python</a></span>
        
          <h1 class="entry-title">What Goes Around, Comes Around</h1>
        
      </header>
      <footer class="entry-meta">
        
        
        
          <img src="http://localhost:4000/images/bio-photo.jpg" class="bio-photo" alt="Carlo Lobrano bio photo"></a>
        
        <span class="author vcard">By <span class="fn">Carlo Lobrano</span></span>
        <span class="entry-date date published"><time datetime="2013-07-28T00:00:00+02:00"><i class="fa fa-calendar-o"></i> July 28, 2013</time></span>
        
        
        
        
      </footer>
      <div class="entry-content">
        <p>Few weeks ago I begun the <a href="https://www.udacity.com/">Udacity</a>’s course <strong>Software Testing</strong>. The course covers the basics of software testing (you don’t say? :D) and it is pretty good since there are video lessons and exercises, quizes to put yourself to the test.</p>

<p>In one of the quizes, as part of a bigger problem (implement the <a href="http://en.wikipedia.org/wiki/Luhn_algorithm">Luhn Checksum</a><a rel="nofollow" href="#footnote1" id="ref_footnote1"><sup>1</sup></a> algorithm), I needed to convert an integer number into a list, that is not a big problem actually, but the implementation gave me a little surprise.</p>

<p>The idea is</p>

<ul>
  <li>divide the number by 10</li>
  <li>push the decimal part into the list</li>
  <li>take the integer part</li>
  <li>repeat all until the integer part is over</li>
</ul>

<p>The following is the code</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">num2list</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">lst</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">while</span> <span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">/</span> <span class="mf">10.0</span>
        <span class="c"># This extracts only the decimal part (e.g. 123.4 - 123 == 0.4)</span>
        <span class="n">dec</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">n</span> <span class="o">-</span> <span class="nb">round</span><span class="p">(</span><span class="n">n</span><span class="p">))</span> <span class="o">*</span> <span class="mf">10.0</span><span class="p">)</span>
        <span class="n">lst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dec</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">lst</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="k">print</span> <span class="n">num2list</span><span class="p">(</span><span class="mi">1234</span><span class="p">)</span></code></pre></div>

<p>surprisingly the result of the test was ‘[1,1,3,4]’. What happened to the number ‘2’?</p>

<p>To better understand the behavior of the code, I added just one print</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">num2list</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">lst</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">while</span> <span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">/</span> <span class="mf">10.0</span>
        <span class="n">dec</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">n</span> <span class="o">-</span> <span class="nb">round</span><span class="p">(</span><span class="n">n</span><span class="p">))</span> <span class="o">*</span> <span class="mf">10.0</span><span class="p">)</span>
        <span class="n">lst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dec</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="s">&#39;n=</span><span class="si">%1.1f</span><span class="s">, round(n)=</span><span class="si">%1.1f</span><span class="s">, [(n-round(n)) x 10]=</span><span class="si">%1.1f</span><span class="s">, dec=</span><span class="si">%d</span><span class="s">&#39;</span> <span class="o">%</span>
               <span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">n</span><span class="p">),</span> <span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="nb">round</span><span class="p">(</span><span class="n">n</span><span class="p">))</span> <span class="o">*</span> <span class="mi">10</span><span class="p">,</span> <span class="n">dec</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">lst</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c"># This is for reverse the list</span></code></pre></div>

<p>the following is the new output</p>

<pre><code>n=123.4, round(n)=123.0, [(n-round(n)) x 10]=4.0, dec=4
n=12.3, round(n)=12.0, [(n-round(n)) x 10]=3.0, dec=3
n=1.2, round(n)=1.0, [(n-round(n)) x 10]=2.0, dec=1
n=0.1, round(n)=0.0, [(n-round(n)) x 10]=1.0, dec=1
[1, 1, 3, 4]
</code></pre>

<p>Ok I know, the output is not very clear, however we can see that the implementation worked well for each iteration except for the third, when the number ‘2’ was expected to be extracted, and not the number ‘1’. In fact at the third step, when n=1.20, the value of the following expression</p>

<pre><code>[(n-round(n)) x 10] =
= [(1.2 - 1.0) * 10.0]
</code></pre>

<p>is equal to ‘2.0’ as expected, but the value of the variable ‘dec’ (just the integer part of the previous result) became ‘1’ out of the blue (or so it seemed)!
It took me a little time to figure out the problem (basically to be sure that the fault was not in the code), but then I got it: the approximation!
Actually the debug message prints ‘2.0’ approximating to <strong>the closer value</strong>, while the actual value is something like 1.9999999999…, so taking only the integer part result in having just ‘1’.
The fix is to apply the operator ‘int’ to the ‘round’ approximation of ‘[(n-round(n)) x 10], that by definition (see <a href="http://docs.python.org/2/library/functions.html#round">here</a>).</p>

<blockquote>
  <p>Values are rounded to the closest multiple of 10</p>
</blockquote>

<p>so this is the final function</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">def</span> <span class="nf">num2list</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">print</span> <span class="n">n</span>
    <span class="n">lst</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">while</span> <span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">/</span> <span class="mf">10.0</span>
        <span class="n">dec</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">((</span><span class="n">n</span> <span class="o">-</span> <span class="nb">round</span><span class="p">(</span><span class="n">n</span><span class="p">))</span> <span class="o">*</span> <span class="mf">10.0</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">dec</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">dec</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">-</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dec</span><span class="p">)</span>
        <span class="n">lst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dec</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">lst</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span></code></pre></div>

<p>When a non negative check of ‘dec’ has been added to cope with the numbers &gt; 5</p>

<pre><code>Without the check if n = 1.6
round(n) = 2.0 (instead of 1.0)
n - round(n) = -0.4 (instead of 0.6) and dec == 4

With the check since dec is negative (-4)
dec = 10 - 4 = 6 OK!
</code></pre>

<p>an alternative would be</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="k">if</span> <span class="nb">round</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">n</span><span class="p">:</span>
    <span class="n">dec</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">-</span> <span class="n">n</span><span class="o">...</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">dec</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="nb">round</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">...</span></code></pre></div>

<h4 id="footnotes">Footnotes</h4>
<ol>
  <li>The test warned to avoid checking Wikipedia about the Luhn algorithm because in the same page there is a (really better than mine :D) python example <a rel="nofollow" href="#ref_footnote1" id="footnote1">[↩]</a>.</li>
</ol>


        
      </div><!-- /.entry-content -->
    </div><!-- /.entry-wrapper -->
    <nav class="pagination" role="navigation">
      
        <a href="http://localhost:4000/blog/read-a-file-in-just-one-line-in-java/" class="btn" title="Read a file in just one line with Java">Previous</a>
      
      
        <a href="http://localhost:4000/articles/top-things-to-do-after-installing-ubuntu-the-script/" class="btn" title="Top Things to Do After Installing Ubuntu. the Script">Next</a>
      
    </nav><!-- /.pagination -->
  </article>
</div><!-- /#main -->

<div class="footer-wrapper">
  <footer role="contentinfo" class="entry-wrapper">
    

<span>&copy; 2015 Carlo Lobrano. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> using the <a href="http://mademistakes.com/so-simple/" rel="nofollow">So Simple Theme</a>.</span>
<div class="social-icons">
	<a href="https://twitter.com/carlolobrano" title="Carlo Lobrano on Twitter" target="_blank"><i class="fa fa-twitter-square fa-2x"></i></a>
	
	
	<a href="https://linkedin.com/in/carlolobrano" title="Carlo Lobrano on LinkedIn" target="_blank"><i class="fa fa-linkedin-square fa-2x"></i></a>
	<a href="http://stackoverflow.com/users/1197008/carlo" title="Carlo Lobrano on StackExchange" target="_blank"><i class="fa fa-stack-exchange fa-2x"></i></a>
	<a href="https://instagram.com/carlo.lobrano" title="Carlo Lobrano on Instagram" target="_blank"><i class="fa fa-instagram fa-2x"></i></a>
	
	<a href="https://github.com/clobrano" title="Carlo Lobrano on Github" target="_blank"><i class="fa fa-github-square fa-2x"></i></a>
	
  
	
  <a href="http://localhost:4000/feed.xml" title="Atom/RSS feed"><i class="fa fa-rss-square fa-2x"></i></a>
</div><!-- /.social-icons -->

  </footer>
</div><!-- /.footer-wrapper -->

<script type="text/javascript">
  var BASE_URL = 'http://localhost:4000';
</script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="http://localhost:4000/assets/js/vendor/jquery-1.9.1.min.js"><\/script>')</script>
<script src="http://localhost:4000/assets/js/scripts.min.js"></script>




</body>
</html>
